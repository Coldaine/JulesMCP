# Jules Control Room Examples

This directory contains example code demonstrating how to use the Jules Control Room backend.

## Prerequisites

1. Install dependencies: `npm install`
2. Build the project: `npm run build`
3. Start the server: `npm start` (or `npm run dev` for development mode)

## Examples

### 1. API Example (Bash Script)

Demonstrates all API endpoints using curl:

```bash
# Make sure the server is running first
npm start

# In another terminal:
./examples/api-example.sh
```

This will:
- Generate a JWT token
- Test health endpoints
- Create, list, get, update, and delete sessions
- Test authentication

### 2. WebSocket Example

Shows how to connect to the WebSocket server and receive real-time updates:

```bash
# Install tsx if not already installed
npm install -g tsx

# Run the example
tsx examples/websocket-example.ts
```

Features demonstrated:
- JWT authentication for WebSocket connections
- Subscribing to session updates
- Receiving welcome and session-update messages
- Heartbeat mechanism

### 3. HTTP Client Example

Demonstrates the JulesClient HTTP client with retries and logging:

```bash
# Note: This example makes requests to a mock API
# Modify the BASE_URL to point to your actual API

tsx examples/client-example.ts
```

Features demonstrated:
- GET, POST, PUT, DELETE requests
- Custom headers
- Error handling
- Automatic retries
- Request logging with sensitive data redaction

## Quick Test

To quickly test the entire system:

```bash
# Terminal 1: Start the server
npm start

# Terminal 2: Run API examples
./examples/api-example.sh

# Terminal 3: Test WebSocket (optional)
tsx examples/websocket-example.ts
```

## Authentication

All examples use JWT tokens for authentication. The token is generated using:

```javascript
const jwt = require('jsonwebtoken');
const token = jwt.sign(
  { userId: 'your-user-id', isAdmin: false },
  process.env.JWT_SECRET || 'your-secret-key-change-in-production',
  { expiresIn: '1h' }
);
```

In production, tokens should be:
- Generated by your authentication service
- Stored securely (not in code)
- Have appropriate expiration times
- Use strong, unique JWT secrets

## Notes

- The examples use the default JWT secret from `.env.example`
- In production, always use a strong, unique JWT secret
- WebSocket connections require a valid JWT token in the query string
- All API endpoints under `/api/*` require authentication
